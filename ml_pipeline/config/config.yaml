# ==============================================================================
# |||           MASTER CONFIGURATION FOR GDM PIPELINE (V4.0)             |||
# ==============================================================================
# This file is the single source of truth for all pipeline parameters.
# It is organized into logical sections for clarity and ease of maintenance.
# ==============================================================================

# ==============================================================================
# 1. GLOBAL SETTINGS & PATHS
# High-level settings that apply across the entire project.
# ==============================================================================
global_settings:
  random_seed: 42
  target_column: 'GDM01'
  artifacts_root: "outputs"

# ==============================================================================
# 2. VISUALIZATION PARAMETERS
# Settings for all plots and graphs generated by the pipeline.
# ==============================================================================
visualizations:
  dpi: 150
  figure_size: [12, 8]
  title_font_size: 16
  label_font_size: 12
  
  color_palette:
    CTGAN: "#87CEEB"      # Sky Blue (Primary)
    TVAE: "#76D7C4"       # Medium Aquamarine (Secondary)
    Real_Data: "#FF7F50"  # Coral (Accent)

# ==============================================================================
# 3. FEATURE ENGINEERING & SELECTION
# Parameters controlling how data features are processed and selected.
# ==============================================================================
feature_params:
  final_predictor_list:
    - 'Thyroid all'
    - 'MA'
    - 'Parity'
    - 'Conception ART 01'
    - 'Smoking01'
    - 'Wt pre'
    - 'Ht'
    - 'Wgain'
    - 'GA days'
    - 'days in 2nd tr'
    - 'PI Ut A'
    - 'BMI'
    - 'Weight_Gain_Rate'
    - 'Relative_Wgain'
    - 'MA_squared'
    - 'Risk_Factor_Count'
  
  skewed_features:
    - 'Wt pre'
    - 'Parity'
    - 'Wgain'
    - 'Relative_Wgain'

# ==============================================================================
# 4. WORKFLOWS
# This section defines the parameters for the different pipeline workflows.
# Each sub-section corresponds to a major, runnable pipeline.
# ==============================================================================

# ------------------------------------------------------------------------------
# 4.1. Original Pipeline Workflow (Full End-to-End)
# ------------------------------------------------------------------------------
original_pipeline:
  data_preparation:
    holdout_split_ratio: 0.1
    n_folds: 10
    leakage_features_to_exclude:
      - 'Time of Diagnosis'
      - 'Early Diagnosis 01'
      - 'Treatment'
      - 'Insulin01'
  
  cross_validation:
    models_to_test: ['RandomForest', 'LogisticRegression', 'XGBoost']
    early_stopping:
      pruning_n_startup_trials: 5 
      patience: 20
      min_delta: 0.001
    full_run:
      n_trials_classical: 150
      n_trials_synthesizer: 75
      synthesizer_epochs: 500
    smoke_test:
      n_trials_classical: 2
      n_trials_synthesizer: 2
      synthesizer_epochs: 2

  evaluation:
    primary_metrics: ['BalancedAccuracy', 'MCC', 'F2', 'GMean']
    generate_pca_plot: true
    generate_propensity_plot: true
    generate_correlation_heatmaps: true
    generate_feature_distribution_plots: true

# ------------------------------------------------------------------------------
# 4.2. Dimitris Pipeline Workflow (External Datasets)
# ------------------------------------------------------------------------------
dimitris_pipeline:
  data_path: "data/preprocessed_folds"

  # --- Tuning Stage ---
  tuning:
    output_directory: "outputs/"
    full_run:
      n_trials: 30
    smoke_test:
      n_trials: 2
    
    hyperparameters_tvae:
      embedding_dim: [128, 256]
      compress_dims: [[256, 256], [512, 512]]
      decompress_dims: [[256, 256], [512, 512]]
      batch_size: [500, 1000]
      epochs: 500
      
    hyperparameters_ctgan:
      embedding_dim: [128, 256]
      generator_dim: [[256, 256], [512, 512]]
      discriminator_dim: [[256, 256], [512, 512]]
      batch_size: [500, 1000]
      epochs: 500

  # --- Generation Stage (Baseline) ---
  generation:
    full_run:
      synthesizer_epochs: 500
    smoke_test:
      synthesizer_epochs: 2

  # --- Evaluation Stage ---
  evaluation:
    models_to_test: ['RandomForest', 'XGBoost']
    generate_pca_plot: true
    generate_propensity_plot: true
    generate_correlation_heatmaps: true
    generate_feature_distribution_plots: true
    full_run:
      n_trials: 150
    smoke_test:
      n_trials: 2

final_pipeline:
  data_path: "data/filtered_data/dataset_filtered.csv"
  artifacts_root: "outputs/final_pipeline_run"
  
  hyperparameters:
    ctgan:
      embedding_dim: 128
      generator_dim: [256, 256]
      discriminator_dim: [256, 256]
      batch_size: 500
      epochs: 500 # Final training epoch count
      verbose: True
    tvae:
      embedding_dim: 128
      compress_dims: [256, 256]
      decompress_dims: [256, 256]
      batch_size: 500
      epochs: 500 # Final training epoch count

  
  # --- Tuning Stage ---
  tuning:
    output_directory: "outputs/"
    full_run:
      n_trials: 30
    smoke_test:
      n_trials: 2
    
    hyperparameters_tvae:
      embedding_dim: [128, 256]
      compress_dims: [[256, 256], [512, 512]]
      decompress_dims: [[256, 256], [512, 512]]
      batch_size: [500, 1000]
      epochs: 500
      
    hyperparameters_ctgan:
      embedding_dim: [128, 256]
      generator_dim: [[256, 256], [512, 512]]
      discriminator_dim: [[256, 256], [512, 512]]
      batch_size: [500, 1000]
      epochs: 500

  # --- Generation Stage (Baseline) ---
  generation:
    full_run:
      synthesizer_epochs: 500
    smoke_test:
      synthesizer_epochs: 2

  # --- Evaluation Stage ---
  evaluation:
    models_to_test: ['RandomForest', 'XGBoost']
    generate_pca_plot: true
    generate_propensity_plot: true
    generate_correlation_heatmaps: true
    generate_feature_distribution_plots: true
    full_run:
      n_trials: 150
    smoke_test:
      n_trials: 2
